<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CDMA Python: User documentation</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">CDMA Python
   
   </div>
   <div id="projectbrief">Python binding to the CDMA C++ library</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">User documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Welcome to the users documentation of the CDMA Python bindings. If you only want to use CDMA in your Python code you are at the right place. If you have already had a look on the C++ and Java API documentation you may find that the Python bindings look entirely different from what you have seen there. The reason for this is simple: the primary design goal for the Python binding was to keep the interface as simple and pythonic as possible. Consequently, I have stripped down the C++ API to a very simple Python API which treats most of the objects in CDMA as containers. If you find that some things look quite similar to h5py (a Python interface to HDf5) then you are entirely right: h5py was quite an inspiration for this binding. This manual is split into several parts. In the next section a short introduction to CDMA will be given. Section <a class="el" href="user_doc.html#udoc_basics">Baisc usage</a> shows gives an overview over the different types provided by the CDMA Python bindings. Finally section <a class="el" href="user_doc.html#udoc_examples">Examples</a> shows some real world examples.</p>
<h2><a class="anchor" id="udoc_introduction"></a>
CDMA at a glance</h2>
<div align="right" style="width:500;float:right;border-width:20px;margin-right:20px"> <div class="image">
<img src="tree.svg" alt="tree.svg"/>
<div class="caption">
CDMA data tree</div></div>
</div><p>Lets start with a quick introduction to CDMA. CDMA maps one or more files and the data stored in them on a tree consisting of <em>Groups</em>, <em>DataItems</em>, <em>Dimensions</em>, and <em>Attributes</em> as shown in the figure on the right. For users acquainted with HDF5 this picture fill look quite familiar. Indeed, except for <code>Dimensions</code>, CDMA provides you with a data organization quite similar to HDF5. Groups and DataItems can additionally hold attributes with additional meta-data. Access to data is provided in two different ways</p>
<ul>
<li>
raw access - is just what you see in the figure above </li>
<li>
a dictionary based approach  </li>
</ul>
<p>As the Python bindings do not yet support dictionary access a detailed description will be omitted. In the <em>raw</em> mode, data is accessed directly by traversing through the data tree. To represent the data tree the Python bindings provide a couple of types (classes). Namely </p>
<ul>
<li><code>Group</code> </li>
<li><code>DataItem</code> </li>
<li><code>Attribute</code> </li>
<li><code>Dimension</code> </li>
<li>and <code>Dataset</code> </li>
</ul>
<p>where the later one acts only as an entry level type to the data-tree.</p>
<h2><a class="anchor" id="udoc_basics"></a>
Baisc usage</h2>
<p>To use CDMA from python the <code>cdma</code> module must be loaded with </p>
<div class="fragment"><pre class="fragment"><span class="keyword">import</span> cdma
</pre></div><p> CDMA organizes data in so called datasets. To open a dataset use </p>
<div class="fragment"><pre class="fragment">dataset = cdma.open_dataset(<span class="stringliteral">&quot;file:/path/to/file&quot;</span>)
</pre></div><p> <code>open_dataset</code> takes one argument which is the URL to the dataset (here a file). Datasets are the entry level objects for the data tree. To get access to the tree use the <code>root_group</code> attribute of the <code>Dataset</code> instance. </p>
<div class="fragment"><pre class="fragment">dataset.root_group
</pre></div><h3><a class="anchor" id="udoc_groups"></a>
Group objects</h3>
<p>Groups are the fundamental container types in CDMA you can iterate over a group with </p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">for</span> o in dataset.root_group:
    print o 
</pre></div><p> This code will iterate over all child objects of the root group. There exist some convenience functions to filter for a particular type of child objects </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#iterate over all children of type DataItem</span>
<span class="preprocessor"></span><span class="keywordflow">for</span> o in cdma.get_dataitems(dataset.root_group):
    print o

<span class="preprocessor">#iterate over all children of type Group</span>
<span class="preprocessor"></span><span class="keywordflow">for</span> g in cdma.get_groups(dataset.root_group):
    print g

<span class="preprocessor">#iterate over all children of type Dimension</span>
<span class="preprocessor"></span><span class="keywordflow">for</span> d in cdma.get_dimensions(dataset.root_group):
    print d
</pre></div><p> To access a particular item below a group the <code></code>[] operator can be used with </p>
<div class="fragment"><pre class="fragment">root = dataset.root_group
group = root[<span class="stringliteral">&quot;groupname&quot;</span>]
item  = root[<span class="stringliteral">&quot;dataitemname&quot;</span>]
dim   = root[<span class="stringliteral">&quot;dimensionname&quot;</span>]
</pre></div><p> Unlike for instance <code>h5py</code> the Python bindings to CDMA do not support access via a path as the argument to <code></code>[]. Only children linked directly below the group can be accessed using their name. A group object has several read only attributes that can be used to obtain some more detailed information about an object. </p>
<div class="fragment"><pre class="fragment">group = dataset.root_group[<span class="stringliteral">&quot;datagroup&quot;</span>]
group.parent     #reference to the parent group (in <span class="keyword">this</span> <span class="keywordflow">case</span> the root group)
group.root       #a reference to the root group of the data tree
group.name       #the full name of the group
group.location   #path to the group within the tree
group.short_name #the key of the group (in <span class="keyword">this</span> <span class="keywordflow">case</span> <span class="stringliteral">&quot;datagroup&quot;</span>)
</pre></div><p> There is one more member attribute to <code>Group</code> which will be discussed in the <a class="el" href="user_doc.html#udoc_attributes">Managing attributes</a> section of this manual.</p>
<h3><a class="anchor" id="udoc_dataitesm"></a>
DataItem objects</h3>
<p>Instances of <code>DataItem</code> are possible child nodes of groups. Unlike groups a data item cannot hold child objects (they are leaves in the terminology of trees) except attributes. Data items contain the data stored in the tree. This data can be either of a numerical or a string type. In addition data can be stored either as a scalar value or as a multidimensional array. An instance of <code>DataItem</code> possesses the same attributes as an instance of <code>Group</code> (see the previous section) along with some additional attributes </p>
<div class="fragment"><pre class="fragment">item = group[<span class="stringliteral">&quot;itemname&quot;</span>]

item.rank        #number of dimensions
item.shape       #tuple with the number of elements along each dimension
item.size        #total number of elements stored in the item
item.unit        #physical unit of the data stored in the item
item.type        #data type as numpy type <span class="keywordtype">string</span>
item.description #description of the item as <span class="keywordtype">string</span>
</pre></div><h3><a class="anchor" id="udoc_attributes"></a>
Managing attributes</h3>
<h3><a class="anchor" id="udoc_dimensions"></a>
Dimensions</h3>
<p>TO DO</p>
<h2><a class="anchor" id="udoc_examples"></a>
Examples</h2>
<p>In this section we will discuss the examples shipped with the source distribution.</p>
<h3><a class="anchor" id="udoc_ex1"></a>
ex1.py</h3>
<p>This examples shows basic navigation and iteration over all entities in a CDMA tree. </p>
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">#!/usr/bin/env python</span>
<a name="l00002"></a>00002 <span class="comment">#simple example for opening a dataset</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="keyword">import</span> cdma
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="comment">#open the dataset</span>
<a name="l00007"></a>00007 ds = cdma.open_dataset(<span class="stringliteral">&quot;file:demo.nxs&quot;</span>)
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="comment">#iterate over all group below the root group</span>
<a name="l00010"></a>00010 <span class="keywordflow">for</span> g <span class="keywordflow">in</span> ds.root_group:
<a name="l00011"></a>00011 
<a name="l00012"></a>00012     <span class="comment">#iterate over all groups</span>
<a name="l00013"></a>00013     <span class="keywordflow">for</span> group <span class="keywordflow">in</span> cdma.get_groups(g):
<a name="l00014"></a>00014         <span class="keywordflow">print</span> group
<a name="l00015"></a>00015 
<a name="l00016"></a>00016     <span class="comment">#iterate over all items</span>
<a name="l00017"></a>00017     <span class="keywordflow">for</span> item <span class="keywordflow">in</span> cdma.get_dataitems(g):
<a name="l00018"></a>00018         <span class="keywordflow">print</span> item
<a name="l00019"></a>00019 
<a name="l00020"></a>00020     <span class="comment">#iterate over all dimensions</span>
<a name="l00021"></a>00021     <span class="keywordflow">for</span> dimension <span class="keywordflow">in</span> cdma.get_dimensions(g):
<a name="l00022"></a>00022         <span class="keywordflow">print</span> dimension
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">#get some basic information about the recorded data</span>
<a name="l00025"></a>00025 g = ds.root_group[<span class="stringliteral">&quot;D1A_016_D1A&quot;</span>]
<a name="l00026"></a>00026 <span class="keywordflow">print</span> g[<span class="stringliteral">&quot;experiment_identifier&quot;</span>][...]
<a name="l00027"></a>00027 <span class="keywordflow">print</span> g[<span class="stringliteral">&quot;duration&quot;</span>][...]
<a name="l00028"></a>00028 <span class="keywordflow">print</span> g[<span class="stringliteral">&quot;start_time&quot;</span>][...]
<a name="l00029"></a>00029 <span class="keywordflow">print</span> g[<span class="stringliteral">&quot;end_time&quot;</span>][...]
<a name="l00030"></a>00030 
</pre></div><p>Line 4 imports the CDMA Python bindings. In Line 7 a handler to a dataset is opened using the <code>open_dataset</code> function. The dataset has a read-only attribute referring to is root group.</p>
<h3><a class="anchor" id="udoc_ex2"></a>
ex2.py</h3>
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">#!/usr/bin/env python</span>
<a name="l00002"></a>00002 <span class="comment">#simple example for ploting multidimensional data</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="keyword">import</span> cdma
<a name="l00005"></a>00005 <span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot
<a name="l00006"></a>00006 <span class="keyword">import</span> numpy
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="comment">#open the dataset</span>
<a name="l00009"></a>00009 ds = cdma.open_dataset(<span class="stringliteral">&quot;file:demo.nxs&quot;</span>)
<a name="l00010"></a>00010 dg = ds.root_group[<span class="stringliteral">&quot;D1A_016_D1A&quot;</span>]
<a name="l00011"></a>00011 expid = dg[<span class="stringliteral">&quot;experiment_identifier&quot;</span>][...]
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 ig = dg[<span class="stringliteral">&quot;image#20&quot;</span>]
<a name="l00014"></a>00014 data = ig[<span class="stringliteral">&quot;data&quot;</span>][...]
<a name="l00015"></a>00015 timestamp = ig[<span class="stringliteral">&quot;timestamp&quot;</span>].attrs[<span class="stringliteral">&quot;timestamp&quot;</span>][...]
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 pyplot.figure()
<a name="l00018"></a>00018 pyplot.contourf(numpy.log10(data),40)
<a name="l00019"></a>00019 pyplot.title(expid + <span class="stringliteral">&quot;@&quot;</span> +timestamp)
<a name="l00020"></a>00020 pyplot.savefig(<span class="stringliteral">&quot;test.png&quot;</span>,dpi=300)
<a name="l00021"></a>00021 
</pre></div><h3><a class="anchor" id="udoc_ex3"></a>
ex3.py</h3>
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">#!/usr/bin/env python</span>
<a name="l00002"></a>00002 <span class="comment">#simple example for simple data reduction</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="keyword">import</span> cdma
<a name="l00005"></a>00005 <span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot
<a name="l00006"></a>00006 <span class="keyword">import</span> numpy
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="comment">#open the dataset</span>
<a name="l00009"></a>00009 ds = cdma.open_dataset(<span class="stringliteral">&quot;file:demo.nxs&quot;</span>)
<a name="l00010"></a>00010 dg = ds.root_group[<span class="stringliteral">&quot;D1A_016_D1A&quot;</span>]
<a name="l00011"></a>00011 expid = dg[<span class="stringliteral">&quot;experiment_identifier&quot;</span>][...]
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 itot = []
<a name="l00014"></a>00014 time   = []
<a name="l00015"></a>00015 t0 = 0
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(60):
<a name="l00018"></a>00018     gn = <span class="stringliteral">&quot;image#%i&quot;</span> %(i)
<a name="l00019"></a>00019     <span class="keywordflow">print</span> <span class="stringliteral">&quot;processing image &quot;</span>,gn,<span class="stringliteral">&quot;...&quot;</span>
<a name="l00020"></a>00020     ig = dg[gn]
<a name="l00021"></a>00021     itot.append(ig[<span class="stringliteral">&quot;data&quot;</span>][840:960,320:440].sum())
<a name="l00022"></a>00022     <span class="keywordflow">if</span> <span class="keywordflow">not</span> i: t0 = ig[<span class="stringliteral">&quot;timestamp&quot;</span>][...]
<a name="l00023"></a>00023     time.append(ig[<span class="stringliteral">&quot;timestamp&quot;</span>][...])
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 pyplot.figure()
<a name="l00027"></a>00027 pyplot.plot(numpy.array(time)-t0,numpy.array(itot))
<a name="l00028"></a>00028 pyplot.title(expid + <span class="stringliteral">&quot; total intensity&quot;</span>)
<a name="l00029"></a>00029 pyplot.xlabel(<span class="stringliteral">&quot;time in (%s)&quot;</span> %(ig[<span class="stringliteral">&quot;timestamp&quot;</span>].unit))
<a name="l00030"></a>00030 pyplot.show()
</pre></div> </div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 17 2012 14:40:41 for CDMA Python by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
